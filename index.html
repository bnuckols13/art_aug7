<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Northstar Emotions - Group Therapy Companion</title>
    <style>
        /* Enhanced Trauma-Informed Color Palette */
        :root {
            --primary-calm: #6B73FF;
            --primary-calm-light: #9BA1FF;
            --primary-calm-dark: #4B53DF;
            --secondary-warm: #9B59B6;
            --secondary-warm-light: #B77FC9;
            --accent-joy: #F39C12;
            --accent-joy-light: #F5B041;
            --neutral-light: #F8F9FA;
            --neutral-soft: #E9ECEF;
            --neutral-medium: #CED4DA;
            --text-primary: #2C3E50;
            --text-secondary: #5A6C7D;
            --text-light: #7F8C8D;
            --success: #27AE60;
            --success-light: #52C77E;
            --warning: #E74C3C;
            --warning-light: #EC7063;
            --safe-green: #2ECC71;
            --creative-purple: #8E44AD;
            --connection-blue: #3498DB;
            --shadow-soft: rgba(0, 0, 0, 0.08);
            --shadow-medium: rgba(0, 0, 0, 0.12);
            --shadow-strong: rgba(0, 0, 0, 0.16);
            --gradient-primary: linear-gradient(135deg, var(--primary-calm), var(--secondary-warm));
            --gradient-success: linear-gradient(135deg, var(--success), var(--safe-green));
            --gradient-warm: linear-gradient(135deg, var(--accent-joy), #F5B041);
        }

        /* CSS Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #F5F7FA 0%, #E8F4FD 50%, #F5F7FA 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated Background Elements */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            opacity: 0.03;
            pointer-events: none;
        }

        .bg-circle {
            position: absolute;
            border-radius: 50%;
            background: var(--primary-calm);
            animation: float 20s infinite ease-in-out;
        }

        .bg-circle:nth-child(1) {
            width: 80px;
            height: 80px;
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }

        .bg-circle:nth-child(2) {
            width: 120px;
            height: 120px;
            top: 60%;
            right: 15%;
            animation-delay: 5s;
        }

        .bg-circle:nth-child(3) {
            width: 60px;
            height: 60px;
            bottom: 20%;
            left: 30%;
            animation-delay: 10s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(120deg); }
            66% { transform: translateY(20px) rotate(240deg); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }

        /* Enhanced Header */
        .header {
            background: var(--gradient-primary);
            color: white;
            padding: 40px;
            border-radius: 24px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 40px var(--shadow-medium);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 10s infinite linear;
        }

        @keyframes shimmer {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header h1 {
            font-size: 2.8em;
            font-weight: 300;
            margin-bottom: 10px;
            letter-spacing: -0.5px;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }

        /* Enhanced Progress Bar */
        .progress-container {
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 20px var(--shadow-soft);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .progress-label {
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        .progress-percentage {
            font-weight: 700;
            color: var(--primary-calm);
            font-size: 1.1em;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: var(--neutral-soft);
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 6px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: progress-shine 2s infinite;
        }

        @keyframes progress-shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Enhanced Phase Navigation */
        .phase-nav {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .phase-btn {
            background: white;
            border: 3px solid var(--neutral-soft);
            padding: 16px 28px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            min-width: 180px;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .phase-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: var(--primary-calm-light);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
            opacity: 0.3;
        }

        .phase-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .phase-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px var(--shadow-medium);
        }

        .phase-btn.active {
            background: var(--gradient-primary);
            color: white;
            border-color: var(--primary-calm);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 10px 30px var(--shadow-medium); }
            50% { box-shadow: 0 10px 40px var(--shadow-strong); }
        }

        .phase-btn.completed {
            background: var(--gradient-success);
            color: white;
            border-color: var(--success);
        }

        .phase-btn.completed::after {
            content: '✓';
            position: absolute;
            top: 5px;
            right: 10px;
            background: white;
            color: var(--success);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .phase-btn span {
            position: relative;
            z-index: 1;
        }

        .phase-time {
            font-size: 0.85em;
            opacity: 0.8;
        }

        /* Enhanced Content Area */
        .content-area {
            background: white;
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 10px 40px var(--shadow-medium);
            margin-bottom: 30px;
            min-height: 500px;
            position: relative;
            overflow: hidden;
        }

        .content-area::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        /* Phase Content Animations */
        .phase-content {
            display: none;
            opacity: 0;
        }

        .phase-content.active {
            display: block;
            animation: fadeInUp 0.6s ease-out forwards;
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        /* Enhanced Grounding Phase */
        .grounding-exercise {
            text-align: center;
            padding: 20px;
        }

        .breathing-circle {
            width: 220px;
            height: 220px;
            border: 4px solid var(--primary-calm);
            border-radius: 50%;
            margin: 40px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: breathe 6s infinite ease-in-out;
            background: radial-gradient(circle, rgba(107, 115, 255, 0.15), rgba(155, 89, 182, 0.05));
            box-shadow: 0 0 60px rgba(107, 115, 255, 0.3);
            position: relative;
        }

        .breathing-circle::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 2px solid var(--primary-calm-light);
            animation: breathe-outer 6s infinite ease-in-out;
            animation-delay: 0.3s;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        @keyframes breathe-outer {
            0%, 100% { transform: scale(1.1); opacity: 0.5; }
            50% { transform: scale(1.3); opacity: 0.2; }
        }

        .breathing-text {
            font-size: 1.2em;
            font-weight: 500;
            color: var(--primary-calm);
        }

        .creative-anchors {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .anchor-item {
            background: var(--neutral-light);
            padding: 25px 15px;
            border-radius: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .anchor-item::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: var(--gradient-primary);
            border-radius: 16px;
            opacity: 0;
            transition: opacity 0.4s;
            z-index: -1;
        }

        .anchor-item:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 30px var(--shadow-medium);
        }

        .anchor-item.selected {
            background: var(--gradient-primary);
            color: white;
            transform: scale(1.05);
        }

        .anchor-item.selected::before {
            opacity: 1;
        }

        .anchor-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
            display: block;
        }

        .anchor-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .anchor-desc {
            font-size: 0.85em;
            opacity: 0.8;
        }

        /* Enhanced Check-in Phase */
        .checkin-categories {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        .category-card {
            background: linear-gradient(135deg, rgba(107, 115, 255, 0.05), rgba(155, 89, 182, 0.05));
            padding: 30px;
            border-radius: 20px;
            border-left: 5px solid var(--primary-calm);
            transition: all 0.3s ease;
        }

        .category-card:hover {
            box-shadow: 0 8px 30px var(--shadow-soft);
            transform: translateX(5px);
        }

        .category-card h3 {
            color: var(--primary-calm);
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .category-prompts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .prompt-item {
            background: white;
            padding: 18px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid var(--neutral-soft);
            font-size: 0.95em;
            position: relative;
            overflow: hidden;
        }

        .prompt-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(107, 115, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .prompt-item:hover::before {
            left: 100%;
        }

        .prompt-item:hover {
            border-color: var(--primary-calm);
            transform: translateX(8px);
            box-shadow: 0 4px 20px var(--shadow-soft);
        }

        .prompt-item.selected {
            background: var(--primary-calm-light);
            color: white;
            border-color: var(--primary-calm);
        }

        .response-area {
            width: 100%;
            min-height: 120px;
            border: 2px solid var(--neutral-soft);
            border-radius: 12px;
            padding: 18px;
            font-family: inherit;
            font-size: 16px;
            margin-top: 20px;
            resize: vertical;
            transition: all 0.3s ease;
            background: white;
        }

        .response-area:focus {
            outline: none;
            border-color: var(--primary-calm);
            box-shadow: 0 0 0 3px rgba(107, 115, 255, 0.1);
        }

        /* Enhanced Emotions Grid */
        .emotions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .emotion-star {
            background: var(--gradient-warm);
            color: white;
            padding: 25px 15px;
            border-radius: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 3px solid transparent;
            font-weight: 600;
            font-size: 1.05em;
            position: relative;
            overflow: hidden;
        }

        .emotion-star::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.3), transparent);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .emotion-star:hover::before {
            width: 200px;
            height: 200px;
        }

        .emotion-star:hover {
            transform: scale(1.08) rotate(2deg);
            box-shadow: 0 12px 35px rgba(241, 196, 15, 0.4);
        }

        .emotion-star.selected {
            border-color: var(--warning);
            background: linear-gradient(135deg, var(--warning), var(--warning-light));
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(231, 76, 60, 0.3);
        }

        /* Enhanced Station Cards */
        .stations-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .station-card {
            background: white;
            border-radius: 20px;
            padding: 28px;
            box-shadow: 0 6px 25px var(--shadow-soft);
            border: 3px solid var(--neutral-soft);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .station-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
            transform: scaleX(0);
            transition: transform 0.4s;
        }

        .station-card:hover::before {
            transform: scaleX(1);
        }

        .station-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 35px var(--shadow-medium);
            border-color: var(--primary-calm);
        }

        .station-card.active {
            border-color: var(--primary-calm);
            background: linear-gradient(135deg, rgba(107, 115, 255, 0.05), rgba(52, 152, 219, 0.05));
        }

        .station-card.completed {
            border-color: var(--success);
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.08), rgba(39, 174, 96, 0.05));
        }

        .station-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 18px;
        }

        .station-icon {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 26px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }

        .station-info h3 {
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .station-info h4 {
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 0.95em;
        }

        .station-checkbox {
            margin-top: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .station-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        /* Enhanced Timer */
        .timer-display {
            background: var(--gradient-primary);
            color: white;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            margin: 25px auto;
            font-size: 2.5em;
            font-weight: 700;
            max-width: 300px;
            box-shadow: 0 8px 30px var(--shadow-medium);
            position: relative;
            overflow: hidden;
        }

        .timer-display::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1), transparent);
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            100% { transform: rotate(360deg); }
        }

        .timer-display.warning {
            background: var(--gradient-warm);
            animation: timer-pulse 1s infinite;
        }

        @keyframes timer-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
        }

        /* Enhanced Buttons */
        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
            text-transform: none;
            letter-spacing: 0.3px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px var(--shadow-medium);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-success {
            background: var(--gradient-success);
            color: white;
        }

        .btn-secondary {
            background: var(--neutral-soft);
            color: var(--text-primary);
        }

        .btn span {
            position: relative;
            z-index: 1;
        }

        /* Enhanced Sharing Circle */
        .sharing-circle {
            background: linear-gradient(135deg, rgba(142, 68, 173, 0.08), rgba(52, 152, 219, 0.08));
            border-radius: 24px;
            padding: 35px;
            margin: 25px 0;
            border: 2px solid var(--primary-calm-light);
        }

        .commitment-input {
            width: 100%;
            min-height: 140px;
            border: 2px solid var(--neutral-soft);
            border-radius: 12px;
            padding: 20px;
            font-family: inherit;
            font-size: 16px;
            margin: 20px 0;
            transition: all 0.3s ease;
            background: white;
        }

        .commitment-input:focus {
            outline: none;
            border-color: var(--primary-calm);
            box-shadow: 0 0 0 3px rgba(107, 115, 255, 0.1);
        }

        /* Sound Toggle Enhancement */
        .sound-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid var(--primary-calm);
            border-radius: 50px;
            padding: 14px;
            cursor: pointer;
            box-shadow: 0 4px 20px var(--shadow-medium);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .sound-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px var(--shadow-strong);
        }

        #sound-icon {
            font-size: 1.4em;
            display: block;
        }

        /* Session Summary Enhancement */
        #sessionSummary {
            display: none;
            background: white;
            border-radius: 24px;
            padding: 50px;
            box-shadow: 0 10px 40px var(--shadow-medium);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        #sessionSummary::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--gradient-success);
        }

        .summary-badge {
            background: var(--gradient-success);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin: 30px 0;
            box-shadow: 0 8px 30px rgba(46, 204, 113, 0.3);
        }

        /* Loading States */
        .loading {
            position: relative;
            pointer-events: none;
            opacity: 0.6;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 30px;
            height: 30px;
            border: 3px solid var(--primary-calm);
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            transform: translate(-50%, -50%);
        }

        @keyframes spin {
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        /* Tooltip System */
        .tooltip {
            position: relative;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-primary);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.85em;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .tooltip:hover::after {
            opacity: 1;
        }

        /* Responsive Design Enhancements */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .content-area {
                padding: 30px 20px;
            }
            
            .phase-nav {
                flex-direction: column;
                align-items: stretch;
            }
            
            .phase-btn {
                width: 100%;
            }
            
            .stations-container {
                grid-template-columns: 1fr;
            }
            
            .emotions-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }
            
            .creative-anchors {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            }
            
            .timer-display {
                font-size: 2em;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .header p {
                font-size: 1em;
            }
            
            .btn {
                padding: 14px 24px;
                font-size: 14px;
            }
            
            .category-prompts {
                grid-template-columns: 1fr;
            }
        }

        /* Print Styles */
        @media print {
            .sound-toggle,
            .timer-controls,
            .phase-nav {
                display: none;
            }
            
            .content-area {
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }

        /* Accessibility Enhancements */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0,0,0,0);
            white-space: nowrap;
            border: 0;
        }

        *:focus-visible {
            outline: 3px solid var(--primary-calm);
            outline-offset: 2px;
        }

        /* Dark Mode Support (if needed) */
        @media (prefers-color-scheme: dark) {
            /* Add dark mode styles here if desired */
        }
    </style>
</head>
<body>
    <!-- Background Animation -->
    <div class="bg-animation">
        <div class="bg-circle"></div>
        <div class="bg-circle"></div>
        <div class="bg-circle"></div>
    </div>

    <!-- Sound Toggle -->
    <div class="sound-toggle" onclick="toggleSound()" title="Toggle Sound" role="button" aria-label="Toggle sound effects">
        <span id="sound-icon">🔊</span>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>✨ Northstar Emotions</h1>
            <p>Group Art Therapy Companion - Your journey to authentic emotional expression</p>
        </header>

        <!-- Enhanced Progress Bar -->
        <div class="progress-container">
            <div class="progress-header">
                <span class="progress-label">Session Progress</span>
                <span class="progress-percentage" id="progressPercentage">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
        </div>

        <!-- Phase Navigation -->
        <nav class="phase-nav" role="navigation" aria-label="Session phases">
            <button class="phase-btn active" onclick="showPhase(0)" id="phase-0" aria-current="true">
                <span>🛡️ Grounding</span>
                <span class="phase-time">(10 min)</span>
            </button>
            <button class="phase-btn" onclick="showPhase(1)" id="phase-1">
                <span>💖 Check-In</span>
                <span class="phase-time">(15 min)</span>
            </button>
            <button class="phase-btn" onclick="showPhase(2)" id="phase-2">
                <span>💡 Learning</span>
                <span class="phase-time">(25 min)</span>
            </button>
            <button class="phase-btn" onclick="showPhase(3)" id="phase-3">
                <span>🎨 Create</span>
                <span class="phase-time">(30 min)</span>
            </button>
            <button class="phase-btn" onclick="showPhase(4)" id="phase-4">
                <span>🌟 Share</span>
                <span class="phase-time">(15 min)</span>
            </button>
            <button class="phase-btn" onclick="showPhase(5)" id="phase-5">
                <span>🤝 Commit</span>
                <span class="phase-time">(10 min)</span>
            </button>
        </nav>

        <!-- Main Content Area -->
        <main class="content-area">
            <!-- Phase 1: Grounding -->
            <div class="phase-content active" id="content-0">
                <h2>🛡️ Creative Resource Activation</h2>
                <div class="grounding-exercise">
                    <h3>Somatic Creative Anchoring</h3>
                    <p>Let's wake up your creative resources - the parts of you that know how to play, imagine, and make something from nothing.</p>
                    
                    <div class="breathing-circle">
                        <span class="breathing-text">Breathe & Center</span>
                    </div>

                    <div class="creative-anchors">
                        <div class="anchor-item" onclick="selectAnchor(this)" data-anchor="stone">
                            <span class="anchor-icon">🗿</span>
                            <div class="anchor-title">Stone</div>
                            <div class="anchor-desc">Grounding & Strength</div>
                        </div>
                        <div class="anchor-item" onclick="selectAnchor(this)" data-anchor="fabric">
                            <span class="anchor-icon">🧶</span>
                            <div class="anchor-title">Fabric</div>
                            <div class="anchor-desc">Comfort & Texture</div>
                        </div>
                        <div class="anchor-item" onclick="selectAnchor(this)" data-anchor="clay">
                            <span class="anchor-icon">🏺</span>
                            <div class="anchor-title">Clay</div>
                            <div class="anchor-desc">Malleability & Form</div>
                        </div>
                        <div class="anchor-item" onclick="selectAnchor(this)" data-anchor="crystal">
                            <span class="anchor-icon">🪨</span>
                            <div class="anchor-title">Crystal</div>
                            <div class="anchor-desc">Clarity & Energy</div>
                        </div>
                        <div class="anchor-item" onclick="selectAnchor(this)" data-anchor="leaf">
                            <span class="anchor-icon">🍃</span>
                            <div class="anchor-title">Leaf</div>
                            <div class="anchor-desc">Growth & Nature</div>
                        </div>
                        <div class="anchor-item" onclick="selectAnchor(this)" data-anchor="shell">
                            <span class="anchor-icon">🐚</span>
                            <div class="anchor-title">Shell</div>
                            <div class="anchor-desc">Ocean & Flow</div>
                        </div>
                    </div>

                    <div style="margin: 30px 0; padding: 25px; background: var(--neutral-light); border-radius: 16px;">
                        <h4>Guided Process:</h4>
                        <ol style="text-align: left; max-width: 600px; margin: 0 auto; line-height: 1.8;">
                            <li><strong>Physical Anchoring (3 min):</strong> Choose your object above and visualize holding it</li>
                            <li><strong>Resource Scanning (4 min):</strong> Place one hand on a part of your body that feels curious or alive</li>
                            <li><strong>Integration (3 min):</strong> Connect your object to your creative resource spot</li>
                        </ol>
                    </div>

                    <button class="btn btn-primary" onclick="completePhase(0)">
                        <span>✓ Complete Grounding</span>
                    </button>
                </div>
            </div>

            <!-- Phase 2: Check-In -->
            <div class="phase-content" id="content-1">
                <h2>💖 Emotional Compass Check-In</h2>
                <p>Choose 1-2 prompts from each category that speak to you today:</p>

                <div class="checkin-categories">
                    <div class="category-card">
                        <h3>✨ Moments of Light</h3>
                        <div class="category-prompts">
                            <div class="prompt-item" onclick="selectPrompt(this)">A small thing that made me smile recently...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">A moment this week when I felt most like myself...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">Something beautiful I noticed today...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">A creative impulse or idea that sparked for me...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">Something that made me laugh or feel playful...</div>
                        </div>
                        <textarea class="response-area" placeholder="Your reflections on moments of light..." id="moments-response" aria-label="Moments of light response"></textarea>
                    </div>

                    <div class="category-card">
                        <h3>🎭 What's Taking Up Space</h3>
                        <div class="category-prompts">
                            <div class="prompt-item" onclick="selectPrompt(this)">Something that's been heavy on my mind...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">A feeling that keeps visiting me lately...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">A story I keep telling myself that might not be true...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">Something I'm avoiding or putting off...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">A part of me that feels stuck or frustrated...</div>
                        </div>
                        <textarea class="response-area" placeholder="What's taking up space in your heart and mind..." id="space-response" aria-label="What's taking up space response"></textarea>
                    </div>

                    <div class="category-card">
                        <h3>🌟 Hope & Intentions</h3>
                        <div class="category-prompts">
                            <div class="prompt-item" onclick="selectPrompt(this)">Something I want to explore or discover here...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">A feeling I'd like to invite in today...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">Something I want to be brave about...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">Something I want to create or birth into the world...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">How I want to feel when I leave here today...</div>
                        </div>
                        <textarea class="response-area" placeholder="Your hopes and intentions for today..." id="hope-response" aria-label="Hopes and intentions response"></textarea>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="completePhase(1)">
                        <span>✓ Complete Check-In</span>
                    </button>
                </div>
            </div>

            <!-- Phase 3: Learning -->
            <div class="phase-content" id="content-2">
                <h2>💡 Northstar Emotions & Creative Blocks</h2>
                
                <div style="background: linear-gradient(135deg, rgba(155, 89, 182, 0.1), rgba(52, 152, 219, 0.1)); padding: 35px; border-radius: 20px; margin: 25px 0;">
                    <h3>✨ Choose Your Northstar Emotion</h3>
                    <p>These aren't just 'nice feelings' - they're compass points showing us your truest self.</p>
                    
                    <div class="emotions-grid">
                        <div class="emotion-star" onclick="selectEmotion(this, 'Joy')" data-emotion="Joy">✨ Joy</div>
                        <div class="emotion-star" onclick="selectEmotion(this, 'Creativity')" data-emotion="Creativity">🎨 Creativity</div>
                        <div class="emotion-star" onclick="selectEmotion(this, 'Love')" data-emotion="Love">💕 Love</div>
                        <div class="emotion-star" onclick="selectEmotion(this, 'Connection')" data-emotion="Connection">🤝 Connection</div>
                        <div class="emotion-star" onclick="selectEmotion(this, 'Peace')" data-emotion="Peace">☮️ Peace</div>
                        <div class="emotion-star" onclick="selectEmotion(this, 'Wonder')" data-emotion="Wonder">🌟 Wonder</div>
                        <div class="emotion-star" onclick="selectEmotion(this, 'Freedom')" data-emotion="Freedom">🕊️ Freedom</div>
                        <div class="emotion-star" onclick="selectEmotion(this, 'Authenticity')" data-emotion="Authenticity">🦋 Authenticity</div>
                        <div class="emotion-star" onclick="selectEmotion(this, 'Playfulness')" data-emotion="Playfulness">🎭 Playfulness</div>
                        <div class="emotion-star" onclick="selectEmotion(this, 'Courage')" data-emotion="Courage">🦁 Courage</div>
                    </div>
                </div>

                <div style="margin: 30px 0; padding: 30px; background: white; border-radius: 20px; border-left: 5px solid var(--warning); box-shadow: 0 4px 20px var(--shadow-soft);">
                    <h3>🧊 Understanding Creative Blocks</h3>
                    <h4>The Creative Block Iceberg:</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 25px 0;">
                        <div style="padding: 25px; background: rgba(231, 76, 60, 0.08); border-radius: 12px;">
                            <h5 style="color: var(--warning); margin-bottom: 15px;">🔍 What We See Above Water:</h5>
                            <ul style="line-height: 1.8;">
                                <li>"I can't do this"</li>
                                <li>"I'm not good at art"</li>
                                <li>"This is stupid"</li>
                                <li>"Everyone will judge me"</li>
                            </ul>
                        </div>
                        <div style="padding: 25px; background: rgba(52, 152, 219, 0.08); border-radius: 12px;">
                            <h5 style="color: var(--connection-blue); margin-bottom: 15px;">🌊 What's Below the Surface:</h5>
                            <ul style="line-height: 1.8;">
                                <li>Fear of vulnerability</li>
                                <li>Past criticism trauma</li>
                                <li>Perfectionism patterns</li>
                                <li>Comparison & shame</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div style="background: var(--gradient-success); color: white; padding: 30px; border-radius: 20px; margin: 25px 0; box-shadow: 0 6px 25px rgba(46, 204, 113, 0.3);">
                    <h3>🎯 Art as Emotional Archaeology</h3>
                    <p style="font-size: 1.05em; line-height: 1.7;">Today we're not making 'good art' - we're making brave art that helps us dig toward our northstar emotion. Creative expression helps us excavate buried emotions, practice feeling without fixing, and build new neural pathways toward joy.</p>
                </div>

                <div style="text-align: center; margin-top: 35px;">
                    <button class="btn btn-primary" onclick="completePhase(2)">
                        <span>✓ Ready to Create</span>
                    </button>
                </div>
            </div>

            <!-- Phase 4: Creative Exploration -->
            <div class="phase-content" id="content-3">
                <h2>🎨 Multi-Modal Creative Exploration</h2>
                <p style="text-align: center; font-size: 1.1em; margin-bottom: 30px;">Choose your creative station and spend 30 minutes diving deep into your artistic exploration!</p>

                <div style="background: white; padding: 20px; border-radius: 16px; margin: 20px auto; max-width: 500px; box-shadow: 0 4px 20px var(--shadow-soft);">
                    <h4 style="text-align: center; margin-bottom: 15px;">⏱️ Set Your Creative Time</h4>
                    <div style="display: flex; gap: 10px; justify-content: center; align-items: center; margin-bottom: 15px;">
                        <input type="number" id="minutesInput" min="1" max="120" value="30" style="width: 80px; padding: 10px; border: 2px solid var(--primary-calm); border-radius: 8px; font-size: 18px; text-align: center;">
                        <span style="font-size: 16px; color: var(--text-secondary);">minutes</span>
                        <button class="btn btn-primary" onclick="setCustomTime()" style="padding: 10px 20px;">
                            <span>Set Time</span>
                        </button>
                    </div>
                    <div style="display: flex; gap: 8px; justify-content: center; flex-wrap: wrap;">
                        <button class="btn btn-secondary" onclick="quickSetTime(5)" style="padding: 8px 16px; font-size: 14px;">
                            <span>5 min</span>
                        </button>
                        <button class="btn btn-secondary" onclick="quickSetTime(10)" style="padding: 8px 16px; font-size: 14px;">
                            <span>10 min</span>
                        </button>
                        <button class="btn btn-secondary" onclick="quickSetTime(15)" style="padding: 8px 16px; font-size: 14px;">
                            <span>15 min</span>
                        </button>
                        <button class="btn btn-secondary" onclick="quickSetTime(20)" style="padding: 8px 16px; font-size: 14px;">
                            <span>20 min</span>
                        </button>
                        <button class="btn btn-secondary" onclick="quickSetTime(30)" style="padding: 8px 16px; font-size: 14px;">
                            <span>30 min</span>
                        </button>
                        <button class="btn btn-secondary" onclick="quickSetTime(45)" style="padding: 8px 16px; font-size: 14px;">
                            <span>45 min</span>
                        </button>
                        <button class="btn btn-secondary" onclick="quickSetTime(60)" style="padding: 8px 16px; font-size: 14px;">
                            <span>60 min</span>
                        </button>
                    </div>
                </div>

                <div class="timer-display" id="stationTimer">
                    30:00
                </div>

                <div class="timer-controls">
                    <button class="btn btn-success" onclick="startTimer()">
                        <span>▶️ Start Timer</span>
                    </button>
                    <button class="btn btn-secondary" onclick="pauseTimer()">
                        <span>⏸️ Pause</span>
                    </button>
                    <button class="btn btn-secondary" onclick="resetTimer()">
                        <span>🔄 Reset</span>
                    </button>
                    <button class="btn btn-secondary" onclick="addTime()">
                        <span>➕ Add 5 Min</span>
                    </button>
                </div>

                <div style="background: linear-gradient(135deg, rgba(107, 115, 255, 0.1), rgba(155, 89, 182, 0.1)); padding: 25px; border-radius: 16px; margin: 25px 0; text-align: center;">
                    <h3>🎯 Choose Your Creative Station</h3>
                    <p>Select ONE station that calls to you today. Set your timer for as long as you need - from a quick 5-minute exploration to a deep 60-minute journey.</p>
                    <p style="font-size: 0.9em; color: var(--text-secondary); margin-top: 10px;">Remember: This is about process, not product. Take the time you need.</p>
                </div>

                <div class="stations-container">
                    <div class="station-card" onclick="selectStation(this, 0)" data-station="0">
                        <div class="station-header">
                            <div class="station-icon" style="background: var(--gradient-primary);">🎨</div>
                            <div class="station-info">
                                <h3>Visual Arts</h3>
                                <h4>Northstar Self-Portrait</h4>
                            </div>
                        </div>
                        <p><strong>Materials:</strong> Mixed media, magazines, mirrors</p>
                        <p><strong>Prompt:</strong> Create a self-portrait showing you living fully in your northstar emotion. What do you look like when experiencing this feeling?</p>
                        <p style="margin-top: 15px; padding: 15px; background: var(--neutral-light); border-radius: 8px; font-size: 0.9em;">
                            <strong>Suggested Journey (adjust timing as needed):</strong><br>
                            • Opening: Gather materials, breathe, connect with your emotion<br>
                            • Creating: Let your hands lead without judgment<br>
                            • Refining: Add details that feel important<br>
                            • Closing: Step back, observe, appreciate what emerged
                        </p>
                        <div class="station-checkbox">
                            <button class="btn btn-primary" onclick="chooseStation(0)">
                                <span>Choose This Station</span>
                            </button>
                        </div>
                    </div>

                    <div class="station-card" onclick="selectStation(this, 1)" data-station="1">
                        <div class="station-header">
                            <div class="station-icon" style="background: var(--gradient-warm);">💃</div>
                            <div class="station-info">
                                <h3>Movement/Dance</h3>
                                <h4>Blocking & Flowing</h4>
                            </div>
                        </div>
                        <p><strong>Materials:</strong> Space to move, scarves, music</p>
                        <p><strong>Prompt:</strong> Move your body to show what blocks your northstar emotion, then transform that movement to show the emotion flowing freely.</p>
                        <p style="margin-top: 15px; padding: 15px; background: var(--neutral-light); border-radius: 8px; font-size: 0.9em;">
                            <strong>Suggested Journey (adjust timing as needed):</strong><br>
                            • Opening: Warm up, feel into your body<br>
                            • Exploring: Move through what blocks you<br>
                            • Transforming: Shift into flowing movements<br>
                            • Integrating: Find your complete dance
                        </p>
                        <div class="station-checkbox">
                            <button class="btn btn-primary" onclick="chooseStation(1)">
                                <span>Choose This Station</span>
                            </button>
                        </div>
                    </div>

                    <div class="station-card" onclick="selectStation(this, 2)" data-station="2">
                        <div class="station-header">
                            <div class="station-icon" style="background: linear-gradient(135deg, var(--connection-blue), #5DADE2);">✍️</div>
                            <div class="station-info">
                                <h3>Poetry/Writing</h3>
                                <h4>Dear Block, Dear Star</h4>
                            </div>
                        </div>
                        <p><strong>Materials:</strong> Beautiful paper, colored pens</p>
                        <p><strong>Prompt:</strong> Write two letters - one to whatever blocks your northstar emotion, and one to the emotion itself.</p>
                        <p style="margin-top: 15px; padding: 15px; background: var(--neutral-light); border-radius: 8px; font-size: 0.9em;">
                            <strong>Suggested Journey (adjust timing as needed):</strong><br>
                            • Opening: Set up your space, choose your pens<br>
                            • First Letter: Write to your block with curiosity<br>
                            • Second Letter: Write to your northstar emotion<br>
                            • Reflection: Read both letters, notice connections
                        </p>
                        <div class="station-checkbox">
                            <button class="btn btn-primary" onclick="chooseStation(2)">
                                <span>Choose This Station</span>
                            </button>
                        </div>
                    </div>

                    <div class="station-card" onclick="selectStation(this, 3)" data-station="3">
                        <div class="station-header">
                            <div class="station-icon" style="background: linear-gradient(135deg, var(--secondary-warm), var(--creative-purple));">🎭</div>
                            <div class="station-info">
                                <h3>Drama Therapy</h3>
                                <h4>Inner Voice Theater</h4>
                            </div>
                        </div>
                        <p><strong>Materials:</strong> Props, masks, imagination</p>
                        <p><strong>Prompt:</strong> Create a dialogue between the voice that blocks your northstar emotion and the voice that champions it.</p>
                        <p style="margin-top: 15px; padding: 15px; background: var(--neutral-light); border-radius: 8px; font-size: 0.9em;">
                            <strong>Suggested Journey (adjust timing as needed):</strong><br>
                            • Opening: Choose props/masks for each voice<br>
                            • Block Voice: Give voice to what blocks you<br>
                            • Champion Voice: Give voice to your supporter<br>
                            • Dialogue: Let them have a conversation
                        </p>
                        <div class="station-checkbox">
                            <button class="btn btn-primary" onclick="chooseStation(3)">
                                <span>Choose This Station</span>
                            </button>
                        </div>
                    </div>

                    <div class="station-card" onclick="selectStation(this, 4)" data-station="4">
                        <div class="station-header">
                            <div class="station-icon" style="background: var(--gradient-primary);">🎵</div>
                            <div class="station-info">
                                <h3>Music Therapy</h3>
                                <h4>Emotional Soundtrack</h4>
                            </div>
                        </div>
                        <p><strong>Materials:</strong> Instruments, voice, playlist tools</p>
                        <p><strong>Prompt:</strong> Create a musical journey from your block to your northstar emotion.</p>
                        <p style="margin-top: 15px; padding: 15px; background: var(--neutral-light); border-radius: 8px; font-size: 0.9em;">
                            <strong>Suggested Journey (adjust timing as needed):</strong><br>
                            • Opening: Explore sounds that represent your block<br>
                            • Transition: Find sounds for moving through<br>
                            • Arrival: Discover your northstar melody<br>
                            • Complete: Play/sing your full journey
                        </p>
                        <div class="station-checkbox">
                            <button class="btn btn-primary" onclick="chooseStation(4)">
                                <span>Choose This Station</span>
                            </button>
                        </div>
                    </div>

                    <div class="station-card" onclick="selectStation(this, 5)" data-station="5">
                        <div class="station-header">
                            <div class="station-icon" style="background: var(--gradient-success);">✨</div>
                            <div class="station-info">
                                <h3>Open Creative Choice</h3>
                                <h4>Your Way</h4>
                            </div>
                        </div>
                        <p><strong>Materials:</strong> Any available supplies</p>
                        <p><strong>Prompt:</strong> Use any materials in any way that helps you explore your northstar emotion and what gets in its way.</p>
                        <p style="margin-top: 15px; padding: 15px; background: var(--neutral-light); border-radius: 8px; font-size: 0.9em;">
                            <strong>Suggested Journey (adjust timing as needed):</strong><br>
                            • Opening: Trust your intuition, gather what calls<br>
                            • Beginning: Start creating without a plan<br>
                            • Emerging: Follow what wants to happen<br>
                            • Completing: Finish in whatever way feels right
                        </p>
                        <div class="station-checkbox">
                            <button class="btn btn-primary" onclick="chooseStation(5)">
                                <span>Choose This Station</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div id="stationSelected" style="display: none; background: var(--gradient-success); color: white; padding: 25px; border-radius: 16px; margin: 25px 0; text-align: center;">
                    <h3>🎨 Station Selected!</h3>
                    <p style="font-size: 1.1em; margin: 15px 0;">You've chosen your creative journey. Set your timer above for however long you need, then press Start when ready.</p>
                    <p style="font-size: 0.95em;">Remember: There's no wrong way to do this. Trust the process.</p>
                </div>

                <div style="text-align: center; margin-top: 35px;">
                    <button class="btn btn-primary" onclick="completePhase(3)">
                        <span>✓ Ready to Share</span>
                    </button>
                </div>
            </div>

            <!-- Phase 5: Integration & Sharing -->
            <div class="phase-content" id="content-4">
                <h2>🌟 Integration & Sharing Circle</h2>
                
                <div class="sharing-circle">
                    <h3>🖼️ Virtual Gallery Walk</h3>
                    <p style="font-size: 1.05em; line-height: 1.7;">Take a moment to appreciate the creative work you've done today. Notice what emerged, what surprised you, what felt challenging or joyful.</p>
                    
                    <div style="margin: 35px 0;">
                        <h4>Sharing Prompts (Choose what resonates):</h4>
                        <div class="category-prompts">
                            <div class="prompt-item" onclick="selectPrompt(this)">Something surprising that emerged in my work...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">A block I recognized more clearly...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">A moment when I felt my northstar emotion while creating...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">What my creation taught me that I didn't expect...</div>
                            <div class="prompt-item" onclick="selectPrompt(this)">How it felt to practice my northstar emotion through art...</div>
                        </div>
                    </div>

                    <textarea class="response-area" placeholder="Share what feels authentic and safe for you..." style="min-height: 160px;" aria-label="Sharing response"></textarea>
                </div>

                <div style="background: linear-gradient(135deg, rgba(46, 204, 113, 0.1), rgba(52, 152, 219, 0.1)); padding: 30px; border-radius: 20px; margin: 25px 0;">
                    <h3>🤝 Group Wisdom Questions</h3>
                    <ul style="text-align: left; max-width: 700px; margin: 0 auto; line-height: 2;">
                        <li>What do you notice about how blocks show up in our creative work?</li>
                        <li>How did it feel to practice your northstar emotion through art?</li>
                        <li>What made it easier or harder to access that positive feeling?</li>
                        <li>What connections do you see between your work and others'?</li>
                    </ul>
                </div>

                <div style="text-align: center; margin-top: 35px;">
                    <button class="btn btn-primary" onclick="completePhase(4)">
                        <span>✓ Ready for Commitment</span>
                    </button>
                </div>
            </div>

            <!-- Phase 6: Check-Out & Commitment -->
            <div class="phase-content" id="content-5">
                <h2>🤝 Creative Commitment Circle</h2>
                
                <div style="text-align: center; margin: 35px 0;">
                    <div style="background: var(--gradient-primary); color: white; padding: 35px; border-radius: 24px; box-shadow: 0 8px 30px var(--shadow-medium);">
                        <h3>✨ Integration Moment</h3>
                        <p style="font-size: 1.1em; margin-bottom: 25px;">Place one hand on your heart, take a breath, and notice what you want to remember from today.</p>
                        <div style="margin: 20px 0; padding: 20px; background: rgba(255,255,255,0.15); border-radius: 12px;">
                            <input type="text" id="takeaway-word" placeholder="One word or phrase I'm taking with me..." style="width: 100%; max-width: 400px; padding: 12px; border: none; border-radius: 8px; font-size: 16px; text-align: center;">
                        </div>
                    </div>
                </div>

                <div style="background: white; padding: 35px; border-radius: 20px; margin: 25px 0; border: 3px solid var(--accent-joy); box-shadow: 0 6px 25px var(--shadow-soft);">
                    <h3>🌱 Weekly Commitment</h3>
                    <p style="font-size: 1.05em; margin-bottom: 25px;"><strong>This week, how will you practice moving toward your northstar emotion? How will you notice when blocks show up?</strong></p>
                    
                    <div style="margin: 25px 0;">
                        <h4>Examples for inspiration:</h4>
                        <ul style="text-align: left; color: var(--text-secondary); line-height: 1.8;">
                            <li>"I'll try one small creative act daily"</li>
                            <li>"When I notice the critical voice, I'll remember my artwork"</li>
                            <li>"I'll listen to my playlist when I need to remember who I am"</li>
                            <li>"I'll practice the movement I discovered when I feel blocked"</li>
                        </ul>
                    </div>

                    <textarea class="commitment-input" id="commitment-text" placeholder="My commitment to myself this week..." aria-label="Weekly commitment"></textarea>
                </div>

                <div style="background: linear-gradient(135deg, rgba(243, 156, 18, 0.1), rgba(241, 196, 15, 0.1)); padding: 30px; border-radius: 20px; margin: 25px 0;">
                    <h3>🌟 Collective Intention</h3>
                    <p style="font-size: 1.05em;">Share your northstar emotion as a gift to the group:</p>
                    <div style="text-align: center; margin: 25px 0;">
                        <div style="background: white; padding: 20px; border-radius: 12px; font-size: 1.2em; font-weight: 600; box-shadow: 0 4px 20px var(--shadow-soft);">
                            "I offer <span id="selectedEmotion" style="color: var(--warning);">[Your Northstar Emotion]</span> to this circle."
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin: 45px 0;">
                    <h3 style="color: var(--success); margin-bottom: 20px;">🙏 Closing Blessing</h3>
                    <p style="font-size: 1.3em; font-style: italic; color: var(--text-secondary); margin-bottom: 30px;">
                        "May we all find our way home to the feelings that make us most ourselves."
                    </p>
                    <button class="btn btn-success" onclick="completeSession()" style="font-size: 18px; padding: 18px 40px;">
                        <span>✨ Complete Session</span>
                    </button>
                </div>
            </div>
        </main>

        <!-- Session Summary -->
        <div id="sessionSummary">
            <h2 style="font-size: 2.5em; margin-bottom: 20px;">🌟 Session Complete!</h2>
            <p style="font-size: 1.2em; margin-bottom: 35px;">Thank you for your brave participation in today's Northstar Emotions journey.</p>
            
            <div class="summary-badge">
                <h3 style="font-size: 1.5em; margin-bottom: 15px;">✨ You've Completed All 6 Phases!</h3>
                <p style="font-size: 1.1em;">Your creative courage has opened new pathways to emotional freedom.</p>
            </div>
            
            <div style="background: var(--neutral-light); padding: 25px; border-radius: 16px; margin: 25px 0;">
                <h3 style="margin-bottom: 15px;">📱 Take With You:</h3>
                <ul style="text-align: left; max-width: 500px; margin: 0 auto; line-height: 1.8;">
                    <li>Photo of your artwork (with permission)</li>
                    <li>Your playlist saved</li>
                    <li>Written reflections from today</li>
                    <li>Memory of your northstar emotion experience</li>
                    <li>Your weekly commitment to practice</li>
                </ul>
            </div>

            <div style="background: var(--gradient-success); color: white; padding: 25px; border-radius: 16px; margin: 25px 0;">
                <h3 style="margin-bottom: 15px;">🌱 Continue Your Journey</h3>
                <p style="font-size: 1.05em;">Practice noticing your northstar emotions in daily life. Remember: this creative capacity lives in you always.</p>
            </div>
            
            <button class="btn btn-primary" onclick="resetSession()" style="margin-top: 20px;">
                <span>🔄 Start New Session</span>
            </button>
        </div>
    </div>

    <script>
        // Enhanced Application State Management
        const AppState = {
            currentPhase: 0,
            completedPhases: [],
            selectedEmotion: '',
            selectedAnchor: '',
            timerInterval: null,
            timeRemaining: 300,
            soundEnabled: true,
            sessionStartTime: null,
            stationStatuses: new Array(6).fill(false),
            responses: {
                moments: '',
                space: '',
                hope: '',
                sharing: '',
                commitment: '',
                takeaway: ''
            },
            selectedPrompts: new Set()
        };

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            AppState.sessionStartTime = new Date();
            updateProgress();
            loadUserData();
            setupKeyboardShortcuts();
            setupAutoSave();
            checkReducedMotion();
        }

        // Enhanced Phase Navigation
        function showPhase(phaseIndex) {
            // Validate phase index
            if (phaseIndex < 0 || phaseIndex > 5) return;
            
            // Hide all phase content with fade out
            const contents = document.querySelectorAll('.phase-content');
            contents.forEach(content => {
                content.classList.remove('active');
            });
            
            // Show selected phase with fade in
            setTimeout(() => {
                const targetContent = document.getElementById('content-' + phaseIndex);
                if (targetContent) {
                    targetContent.classList.add('active');
                }
            }, 100);
            
            // Update navigation buttons
            updatePhaseButtons(phaseIndex);
            
            AppState.currentPhase = phaseIndex;
            updateProgress();
            playSound('transition');
            
            // Auto-scroll to top of content
            document.querySelector('.content-area').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function updatePhaseButtons(activeIndex) {
            const buttons = document.querySelectorAll('.phase-btn');
            buttons.forEach((btn, index) => {
                btn.classList.remove('active');
                btn.setAttribute('aria-current', 'false');
                
                if (index === activeIndex) {
                    btn.classList.add('active');
                    btn.setAttribute('aria-current', 'true');
                }
                
                if (AppState.completedPhases.includes(index)) {
                    btn.classList.add('completed');
                }
            });
        }

        // Enhanced Phase Completion
        function completePhase(phaseIndex) {
            if (!AppState.completedPhases.includes(phaseIndex)) {
                AppState.completedPhases.push(phaseIndex);
                document.getElementById('phase-' + phaseIndex).classList.add('completed');
                playSound('success');
                showNotification('Phase completed! 🎉');
            }
            
            // Auto-advance to next phase
            if (phaseIndex < 5) {
                setTimeout(() => {
                    showPhase(phaseIndex + 1);
                }, 1500);
            }
            
            updateProgress();
            saveUserData();
        }

        // Enhanced Progress Tracking
        function updateProgress() {
            const progress = (AppState.completedPhases.length / 6) * 100;
            const progressFill = document.getElementById('progressFill');
            const progressPercentage = document.getElementById('progressPercentage');
            
            if (progressFill) {
                progressFill.style.width = progress + '%';
            }
            
            if (progressPercentage) {
                progressPercentage.textContent = Math.round(progress) + '%';
            }
        }

        // Enhanced Grounding Phase Functions
        function selectAnchor(element) {
            // Remove previous selection
            document.querySelectorAll('.anchor-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // Add selection to clicked element
            element.classList.add('selected');
            AppState.selectedAnchor = element.dataset.anchor;
            
            playSound('select');
            
            // Provide haptic feedback if available
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        // Enhanced Check-in Functions
        function selectPrompt(element) {
            element.classList.toggle('selected');
            const promptText = element.textContent;
            
            if (element.classList.contains('selected')) {
                AppState.selectedPrompts.add(promptText);
            } else {
                AppState.selectedPrompts.delete(promptText);
            }
            
            playSound('select');
        }

        // Enhanced Emotion Selection
        function selectEmotion(element, emotion) {
            // Clear previous selection
            document.querySelectorAll('.emotion-star').forEach(star => {
                star.classList.remove('selected');
            });
            
            // Add selection
            element.classList.add('selected');
            AppState.selectedEmotion = emotion;
            
            // Update display
            const emotionDisplay = document.getElementById('selectedEmotion');
            if (emotionDisplay) {
                emotionDisplay.textContent = emotion;
            }
            
            playSound('star');
            showNotification(`Northstar emotion selected: ${emotion} ✨`);
        }

        // Enhanced Timer Functions
        var timerInterval;
        var timeRemaining = 1800; // Default 30 minutes in seconds
        var totalTime = 1800; // Track total time for notifications
        var selectedStationIndex = null;

        function quickSetTime(minutes) {
            var minutesInput = document.getElementById('minutesInput');
            if (minutesInput) {
                minutesInput.value = minutes;
                setCustomTime();
            }
        }

        function setCustomTime() {
            var minutesInput = document.getElementById('minutesInput');
            if (!minutesInput) return;
            
            var minutes = parseInt(minutesInput.value);
            
            if (isNaN(minutes) || minutes < 1) {
                showNotification('Please enter a valid time (1-120 minutes)');
                return;
            }
            
            if (minutes > 120) {
                showNotification('Maximum time is 120 minutes');
                minutesInput.value = 120;
                return;
            }
            
            if (timerInterval) clearInterval(timerInterval); // Stop any running timer
            timeRemaining = minutes * 60;
            totalTime = minutes * 60;
            updateTimerDisplay();
            var timerElement = document.getElementById('stationTimer');
            if (timerElement) {
                timerElement.classList.remove('warning');
            }
            
            showNotification('Timer set to ' + minutes + ' minute' + (minutes !== 1 ? 's' : ''));
            playSound('select');
        }

        function startTimer() {
            if (selectedStationIndex === null) {
                showNotification('Please choose a station first! 🎨');
                return;
            }
            
            if (timerInterval) clearInterval(timerInterval);
            
            timerInterval = setInterval(function() {
                timeRemaining--;
                updateTimerDisplay();
                
                // Dynamic notifications based on total time
                var percentRemaining = (timeRemaining / totalTime) * 100;
                
                // Notify at 50% (halfway)
                if (Math.abs(percentRemaining - 50) < 0.5) {
                    showNotification('⏰ Halfway there! Keep going!');
                    playSound('chime');
                }
                
                // Warning at 10% or 5 minutes, whichever is larger
                var warningTime = Math.max(totalTime * 0.1, 300);
                if (timeRemaining === Math.round(warningTime)) {
                    var timerElement = document.getElementById('stationTimer');
                    if (timerElement) {
                        timerElement.classList.add('warning');
                    }
                    var warningMinutes = Math.round(warningTime / 60);
                    playSound('warning');
                    showNotification('⏰ ' + warningMinutes + ' minute' + (warningMinutes !== 1 ? 's' : '') + ' remaining - begin wrapping up');
                }
                
                // Final minute warning
                if (timeRemaining === 60) {
                    playSound('warning');
                    showNotification('⏰ One minute remaining!');
                }
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    playSound('completion');
                    var timerElement = document.getElementById('stationTimer');
                    if (timerElement) {
                        timerElement.classList.remove('warning');
                    }
                    var completedMinutes = Math.round(totalTime / 60);
                    showNotification('🎉 Amazing work! Your ' + completedMinutes + '-minute creative exploration is complete!');
                    markStationComplete();
                }
            }, 1000);
            
            var startMinutes = Math.round(totalTime / 60);
            showNotification('Timer started - ' + startMinutes + ' minute' + (startMinutes !== 1 ? 's' : '') + ' of creative exploration! 🎨');
        }

        function pauseTimer() {
            if (timerInterval) clearInterval(timerInterval);
            showNotification('Timer paused - take your time');
        }

        function resetTimer() {
            if (timerInterval) clearInterval(timerInterval);
            var minutesInput = document.getElementById('minutesInput');
            var currentMinutes = minutesInput ? parseInt(minutesInput.value) : 30;
            if (isNaN(currentMinutes)) currentMinutes = 30;
            
            timeRemaining = currentMinutes * 60;
            totalTime = currentMinutes * 60;
            updateTimerDisplay();
            
            var timerElement = document.getElementById('stationTimer');
            if (timerElement) {
                timerElement.classList.remove('warning');
            }
            showNotification('Timer reset to ' + currentMinutes + ' minutes');
        }

        function addTime() {
            timeRemaining += 300; // Add 5 minutes
            totalTime += 300; // Update total time too
            updateTimerDisplay();
            showNotification('Added 5 minutes to your timer');
        }

        function updateTimerDisplay() {
            var minutes = Math.floor(timeRemaining / 60);
            var seconds = timeRemaining % 60;
            var display = (minutes < 10 ? '0' : '') + minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
            
            var timerElement = document.getElementById('stationTimer');
            if (timerElement) {
                timerElement.textContent = display;
            }
        }

        // Station Selection Functions
        function selectStation(element, stationIndex) {
            // Visual feedback only - doesn't select the station
            var cards = document.querySelectorAll('.station-card');
            for (var i = 0; i < cards.length; i++) {
                cards[i].classList.remove('active');
            }
            element.classList.add('active');
        }

        function chooseStation(stationIndex) {
            // This actually selects the station for the session
            selectedStationIndex = stationIndex;
            
            // Clear all selections and mark chosen one
            var cards = document.querySelectorAll('.station-card');
            for (var i = 0; i < cards.length; i++) {
                cards[i].classList.remove('active', 'chosen');
                var btn = cards[i].querySelector('button');
                if (btn) {
                    btn.innerHTML = '<span>Choose This Station</span>';
                    btn.classList.remove('btn-success');
                }
            }
            
            var chosenCard = document.querySelector('[data-station="' + stationIndex + '"]');
            if (chosenCard) {
                chosenCard.classList.add('chosen', 'active');
                var btn = chosenCard.querySelector('button');
                if (btn) {
                    btn.innerHTML = '<span>✓ Station Chosen</span>';
                    btn.classList.add('btn-success');
                }
            }
            
            // Show confirmation message
            var confirmMsg = document.getElementById('stationSelected');
            if (confirmMsg) {
                confirmMsg.style.display = 'block';
            }
            
            // Scroll to timer controls
            var timerControls = document.querySelector('.timer-controls');
            if (timerControls) {
                timerControls.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
            
            playSound('star');
            showNotification('Station selected! Set your timer and begin when ready 🎨');
            
            // Save selection
            AppState.selectedStation = stationIndex;
            saveUserData();
        }

        function markStationComplete() {
            if (selectedStationIndex !== null) {
                var stationCard = document.querySelector('[data-station="' + selectedStationIndex + '"]');
                if (stationCard) {
                    stationCard.classList.add('completed');
                }
                AppState.stationStatuses[selectedStationIndex] = true;
                saveUserData();
            }
        }

        // Complete Session
        function completeSession() {
            // Save final data
            AppState.responses.takeaway = document.getElementById('takeaway-word')?.value || '';
            AppState.responses.commitment = document.getElementById('commitment-text')?.value || '';
            saveUserData();
            
            // Hide main content and show summary
            document.querySelector('.content-area').style.display = 'none';
            document.querySelector('.phase-nav').style.display = 'none';
            document.querySelector('.progress-container').style.display = 'none';
            document.getElementById('sessionSummary').style.display = 'block';
            
            playSound('completion');
            
            // Generate session summary
            generateSessionSummary();
        }

        function resetSession() {
            // Reset all state
            AppState.currentPhase = 0;
            AppState.completedPhases = [];
            AppState.selectedEmotion = '';
            AppState.selectedAnchor = '';
            AppState.stationStatuses = new Array(6).fill(false);
            AppState.responses = {
                moments: '',
                space: '',
                hope: '',
                sharing: '',
                commitment: '',
                takeaway: ''
            };
            AppState.selectedPrompts.clear();
            
            // Reset UI
            document.querySelector('.content-area').style.display = 'block';
            document.querySelector('.phase-nav').style.display = 'flex';
            document.querySelector('.progress-container').style.display = 'block';
            document.getElementById('sessionSummary').style.display = 'none';
            
            // Reset to first phase
            showPhase(0);
            
            // Clear all selections
            document.querySelectorAll('.selected').forEach(el => el.classList.remove('selected'));
            document.querySelectorAll('.completed').forEach(el => el.classList.remove('completed'));
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.querySelectorAll('textarea').forEach(ta => ta.value = '');
            document.querySelectorAll('input[type="text"]').forEach(input => input.value = '');
            
            showNotification('Session reset. Welcome back! 🌟');
        }

        // Enhanced Sound Management
        function toggleSound() {
            AppState.soundEnabled = !AppState.soundEnabled;
            const icon = document.getElementById('sound-icon');
            icon.textContent = AppState.soundEnabled ? '🔊' : '🔇';
            
            if (AppState.soundEnabled) {
                playSound('select');
            }
            
            showNotification(AppState.soundEnabled ? 'Sound enabled' : 'Sound muted');
        }

        function playSound(type) {
            if (!AppState.soundEnabled) return;
            
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                const frequencies = {
                    'transition': 440,
                    'select': 523.25,
                    'success': 659.25,
                    'star': 783.99,
                    'station': 349.23,
                    'chime': 880,
                    'completion': 1046.50,
                    'warning': 392
                };
                
                oscillator.frequency.value = frequencies[type] || 440;
                oscillator.type = 'sine';
                
                // Enhanced envelope for better sound
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.15, audioContext.currentTime + 0.02);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.4);
            } catch (e) {
                console.log('Audio playback not supported:', e);
            }
        }

        // Notification System
        function showNotification(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--gradient-primary);
                color: white;
                padding: 15px 25px;
                border-radius: 50px;
                box-shadow: 0 4px 20px var(--shadow-medium);
                z-index: 2000;
                animation: slideUp 0.3s ease-out;
                font-weight: 500;
            `;
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideDown 0.3s ease-out';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Add CSS for notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideUp {
                from { transform: translateX(-50%) translateY(100px); opacity: 0; }
                to { transform: translateX(-50%) translateY(0); opacity: 1; }
            }
            @keyframes slideDown {
                from { transform: translateX(-50%) translateY(0); opacity: 1; }
                to { transform: translateX(-50%) translateY(100px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Data Persistence
        function saveUserData() {
            const userData = {
                currentPhase: AppState.currentPhase,
                completedPhases: AppState.completedPhases,
                selectedEmotion: AppState.selectedEmotion,
                selectedAnchor: AppState.selectedAnchor,
                stationStatuses: AppState.stationStatuses,
                responses: {
                    moments: document.getElementById('moments-response')?.value || '',
                    space: document.getElementById('space-response')?.value || '',
                    hope: document.getElementById('hope-response')?.value || '',
                    sharing: document.querySelector('#content-4 textarea')?.value || '',
                    commitment: document.getElementById('commitment-text')?.value || '',
                    takeaway: document.getElementById('takeaway-word')?.value || ''
                },
                selectedPrompts: Array.from(AppState.selectedPrompts),
                timestamp: new Date().toISOString()
            };
            
            // Store in memory (localStorage not available in Claude artifacts)
            window.sessionData = userData;
            
            // In production, this would save to a backend
            console.log('Session data saved:', userData);
        }

        function loadUserData() {
            // In production, this would load from backend/localStorage
            if (window.sessionData) {
                // Restore state from saved data
                const data = window.sessionData;
                AppState.currentPhase = data.currentPhase || 0;
                AppState.completedPhases = data.completedPhases || [];
                AppState.selectedEmotion = data.selectedEmotion || '';
                AppState.selectedAnchor = data.selectedAnchor || '';
                AppState.stationStatuses = data.stationStatuses || new Array(6).fill(false);
                AppState.responses = data.responses || {};
                AppState.selectedPrompts = new Set(data.selectedPrompts || []);
                
                // Restore UI state
                showPhase(AppState.currentPhase);
                updateProgress();
            }
            
            updateTimerDisplay();
        }

        // Auto-save functionality
        function setupAutoSave() {
            // Auto-save every 30 seconds
            setInterval(() => {
                saveUserData();
            }, 30000);
            
            // Save on input change
            document.addEventListener('input', (e) => {
                if (e.target.matches('textarea, input[type="text"]')) {
                    clearTimeout(window.saveTimeout);
                    window.saveTimeout = setTimeout(saveUserData, 1000);
                }
            });
        }

        // Generate Session Summary
        function generateSessionSummary() {
            const sessionDuration = Math.round((new Date() - AppState.sessionStartTime) / 60000);
            const completionRate = Math.round((AppState.completedPhases.length / 6) * 100);
            
            console.log(`Session Summary:
                Duration: ${sessionDuration} minutes
                Completion: ${completionRate}%
                Northstar Emotion: ${AppState.selectedEmotion}
                Selected Anchor: ${AppState.selectedAnchor}
                Stations Completed: ${AppState.stationStatuses.filter(s => s).length}/6
            `);
        }

        // Keyboard Shortcuts
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // Alt + number for phase navigation
                if (e.altKey && e.key >= '1' && e.key <= '6') {
                    showPhase(parseInt(e.key) - 1);
                }
                
                // Alt + S for sound toggle
                if (e.altKey && e.key === 's') {
                    toggleSound();
                }
                
                // Alt + T for timer start/pause
                if (e.altKey && e.key === 't') {
                    if (timerInterval) {
                        pauseTimer();
                    } else {
                        startTimer();
                    }
                }
                
                // Escape to close notifications
                if (e.key === 'Escape') {
                    document.querySelectorAll('.notification').forEach(n => n.remove());
                }
            });
        }

        // Accessibility Features
        function checkReducedMotion() {
            const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            
            if (prefersReducedMotion) {
                // Disable animations for users who prefer reduced motion
                document.documentElement.style.setProperty('--animation-duration', '0.01s');
                
                const style = document.createElement('style');
                style.textContent = `
                    *, *::before, *::after {
                        animation-duration: 0.01s !important;
                        transition-duration: 0.01s !important;
                    }
                `;
                document.head.appendChild(style);
            }
        }

        // Responsive adjustments
        function checkScreenSize() {
            const width = window.innerWidth;
            
            if (width < 768) {
                document.body.classList.add('mobile');
            } else {
                document.body.classList.remove('mobile');
            }
            
            // Adjust font sizes for readability
            if (width < 480) {
                document.documentElement.style.fontSize = '14px';
            } else if (width < 768) {
                document.documentElement.style.fontSize = '15px';
            } else {
                document.documentElement.style.fontSize = '16px';
            }
        }

        window.addEventListener('resize', checkScreenSize);
        checkScreenSize();

        // Performance optimization
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(checkScreenSize, 150);
        });

        // Error handling
        window.addEventListener('error', (e) => {
            console.error('Application error:', e);
            showNotification('Something went wrong. Please refresh if issues persist.');
        });

        // Prevent accidental navigation
        window.addEventListener('beforeunload', (e) => {
            if (AppState.completedPhases.length > 0 && AppState.completedPhases.length < 6) {
                e.preventDefault();
                e.returnValue = 'You have an incomplete session. Are you sure you want to leave?';
            }
        });
    </script>
</body>
</html>